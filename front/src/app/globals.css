@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 98%;
    --foreground: 0 0% 15%;  /* Улучшенная контрастность - темнее для лучшей читаемости */
    --card: 0 0% 98%;
    --card-foreground: 0 0% 15%;  /* Улучшенная контрастность */
    --popover: 0 0% 98%;
    --popover-foreground: 0 0% 15%;  /* Улучшенная контрастность */
    --primary: 160 12% 55%;  /* Улучшенная контрастность для доступности */
    --primary-foreground: 0 0% 98%;
    --secondary: 45 18% 95%;
    --secondary-foreground: 0 0% 15%;  /* Улучшенная контрастность */
    --muted: 45 18% 95%;
    --muted-foreground: 0 0% 40%;  /* Улучшенная контрастность для приглушенного текста */
    --accent: 45 18% 95%;
    --accent-foreground: 0 0% 15%;  /* Улучшенная контрастность */
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 45 15% 88%;
    --input: 45 15% 88%;
    --ring: 160 12% 55%;  /* Синхронизировано с primary для консистентности */
    --radius: 1rem;
    
    /* Font variables */
    --font-display: var(--font-cormorant);
    --font-body: var(--font-inter);
    
    /* New brand colors for natural minimalism (HSL format) */
    --roseBeige: 34 35% 93%;   /* #f4efe8 - Rose Beige */
    --mistGray: 39 9% 82%;     /* #d6d3ce - Mist Gray */
    --linenWhite: 0 0% 98%;    /* #f9f9f9 - Linen White */
    --sageTint: 125 8% 70%;    /* #aeb6af - Sage Tint */
    --inkSoft: 0 0% 22%;       /* Улучшенная контрастность - темнее для лучшей заметности текста */
    --soft-shadow: 0 4px 20px rgba(174, 182, 175, 0.08);
    --medium-shadow: 0 8px 30px rgba(174, 182, 175, 0.15);
    --warm-shadow: 0 6px 25px rgba(244, 239, 232, 0.4);
    --breathing-shadow: 0 6px 20px rgba(0, 0, 0, 0.05);
  }

  /* Dark Mode Variables */
  .dark {
    /* Основные фоны */
    --background: 30 11% 9%;           /* Deep Earth */
    --foreground: 35 18% 91%;         /* Moonlit Glow - доработанный лунный свет текста (более яркий и гармоничный) */
    
    /* Карточки и контейнеры */
    --card: 30 9% 15%;                /* Warm Charcoal */
    --card-foreground: 35 18% 91%;    /* Moonlit Glow */
    --popover: 30 9% 15%;             /* Warm Charcoal */
    --popover-foreground: 35 18% 91%; /* Moonlit Glow */
    
    /* Акценты */
    --primary: 35 18% 62%;            /* Moonlit Linen - доработанный лунный свет (более светлый и серебристый) */
    --primary-foreground: 35 18% 91%; /* Moonlit Glow */
    --secondary: 40 5% 22%;           /* Moss Shadow */
    --secondary-foreground: 35 18% 91%; /* Moonlit Glow */
    
    /* Приглушенные элементы */
    --muted: 40 5% 22%;               /* Moss Shadow */
    --muted-foreground: 35 12% 68%;   /* Приглушенный текст - доработанный */
    --accent: 40 5% 22%;              /* Moss Shadow */
    --accent-foreground: 35 18% 91%;  /* Moonlit Glow */
    
    /* Границы и инпуты */
    --border: 40 5% 22%;              /* Moss Shadow */
    --input: 40 5% 22%;               /* Moss Shadow */
    
    /* Фокус и кольца */
    --ring: 35 18% 62%;               /* Moonlit Linen - доработанный */
    
    /* Деструктивные действия */
    --destructive: 0 65% 50%;         /* Приглушенный красный */
    --destructive-foreground: 35 18% 91%; /* Moonlit Glow */
    
    /* Брендовые цвета (Dark Mode адаптация) */
    --roseBeige: 30 9% 15%;           /* Warm Charcoal */
    --mistGray: 40 5% 22%;            /* Moss Shadow */
    --linenWhite: 30 11% 9%;          /* Deep Earth */
    --sageTint: 120 10% 61%;          /* Sage Glow */
    --inkSoft: 35 18% 91%;            /* Moonlit Glow - доработанный */
    
    /* Тени для темной темы */
    --soft-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    --medium-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
    --warm-shadow: 0 6px 25px rgba(143, 166, 143, 0.15);
    --breathing-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    --glow-shadow: 0 0 20px rgba(143, 166, 143, 0.2);
  }
}

@layer base {
  * {
    border-color: hsl(var(--border));
  }
  body {
    @apply bg-white dark:bg-background font-sans;
    font-family: var(--font-body), system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 17px;
    font-weight: 400; /* Нормальный вес для лучшей читаемости */
    line-height: 1.8;
    color: hsl(var(--foreground)) !important;
  }
  
  /* Принудительное переопределение цвета для body в темной теме */
  .dark body {
    color: hsl(var(--foreground)) !important;
  }
  
  /* Плавный переход при смене темы */
  * {
    transition: 
      background-color 0.3s cubic-bezier(0.22, 1, 0.36, 1),
      color 0.3s cubic-bezier(0.22, 1, 0.36, 1),
      border-color 0.3s cubic-bezier(0.22, 1, 0.36, 1);
  }
  
  /* Исключения для анимаций */
  .anim-breath,
  .anim-float,
  .rb-flower,
  .anim-breath-slow,
  .anim-float-slow,
  .rb-bloom-in {
    transition: none; /* Анимации не должны прерываться */
  }
  
  h1, h2, h3 {
    font-family: var(--font-display), "Cormorant Garamond", serif;
    font-weight: 400; /* Нормальный вес для лучшей заметности */
    letter-spacing: 0.02em;
    color: hsl(var(--foreground));
  }
  
  /* Адаптивные line-height для заголовков - улучшает читаемость на мобильных */
  h1 {
    line-height: clamp(1.1, 1.2vw + 0.95, 0.95);
  }
  
  h2 {
    line-height: clamp(1.15, 1.1vw + 1.0, 1.0);
  }
  
  h3 {
    line-height: clamp(1.2, 1.0vw + 1.05, 1.05);
  }
  
  /* Явное переопределение цвета для всех текстовых элементов в темной теме */
  .dark {
    color: hsl(var(--foreground)) !important;
  }
  
  /* Переопределение для всех дочерних элементов - принудительно убираем синий */
  .dark *:not([class*="text-"]):not(svg):not(path):not(circle):not(rect):not(line):not(polygon) {
    color: hsl(var(--foreground)) !important;
  }
  
  /* Исключения для элементов с явно заданным цветом через классы Tailwind */
  .dark [class*="text-"] {
    color: inherit !important;
  }
  
  /* SVG элементы не должны менять цвет */
  .dark svg,
  .dark svg * {
    color: inherit !important;
  }
  
  /* Ссылки без классов - наследуют цвет */
  .dark a:not([class*="text-"]) {
    color: hsl(var(--foreground)) !important;
  }
  
  /* Кнопки без классов - наследуют цвет текста */
  .dark button:not([class*="text-"]) {
    color: hsl(var(--foreground)) !important;
  }
  
  /* Переопределение для всех текстовых элементов */
  .dark p,
  .dark span:not([class*="text-"]),
  .dark div:not([class*="text-"]),
  .dark h1:not([class*="text-"]),
  .dark h2:not([class*="text-"]),
  .dark h3:not([class*="text-"]),
  .dark h4:not([class*="text-"]),
  .dark h5:not([class*="text-"]),
  .dark h6:not([class*="text-"]),
  .dark li,
  .dark td,
  .dark th {
    color: hsl(var(--foreground)) !important;
  }

  /* Form controls: brand focus and autofill reset */
  input, textarea, select {
    accent-color: hsl(var(--sageTint));
    caret-color: hsl(var(--inkSoft));
    background-color: hsl(var(--background)) !important; /* жёстко фиксируем фон */
    color: hsl(var(--foreground));
  }
  
  /* Переопределение для темной темы */
  .dark input,
  .dark textarea,
  .dark select {
    accent-color: hsl(var(--sageTint));
    caret-color: hsl(var(--inkSoft));
    color: hsl(var(--foreground));
  }
  input:focus,
  input:focus-visible,
  textarea:focus,
  textarea:focus-visible,
  select:focus,
  select:focus-visible {
    outline: none !important;
    border-color: hsl(var(--sageTint)) !important;
    /* Мягкий фокус для лучшего UX - уменьшена непрозрачность */
    box-shadow: 0 0 0 2px hsl(var(--sageTint) / 0.3) !important;
  }
  
  /* Focus для темной темы */
  .dark input:focus,
  .dark input:focus-visible,
  .dark textarea:focus,
  .dark textarea:focus-visible,
  .dark select:focus,
  .dark select:focus-visible {
    border-color: hsl(var(--ring)) !important;
    box-shadow: 0 0 0 2px hsl(var(--ring) / 0.3) !important;
  }
  
}

/* ===== RB: Autofill + Focus hard reset ===== */
:root {
  --rb-autofill-bg: hsl(var(--background));
  /* синхронизация нативных контролов с темой */
  --rb-color-scheme: light;
}

.dark {
  --rb-color-scheme: dark;
}

@layer utilities {
  /* Убираем синий tap-highlight на мобильных Safari/Chrome */
  html :is(a, button, input, textarea, select) {
    -webkit-tap-highlight-color: transparent;
  }

  /* Брендовая подсветка выделенного текста внутри input/textarea */
  html input::selection,
  html textarea::selection {
    background: theme(colors.sageTint / 0.35);
    color: hsl(var(--foreground));
  }
  html input::-moz-selection,
  html textarea::-moz-selection {
    background: theme(colors.sageTint / 0.35);
    color: hsl(var(--foreground));
  }

  /* Windows High Contrast / Edge forced-colors — только для наших полей */
  @media (forced-colors: active) {
    html :is(input[data-rb-input], textarea[data-rb-input], select[data-rb-input]) {
      forced-color-adjust: none;
      outline: 0 !important;
      border-color: hsl(var(--input)) !important;
      background-color: Canvas !important; /* системный фон темы, убирает синий */
      color: CanvasText !important;        /* системный цвет текста */
      box-shadow:
        0 0 0 2px var(--tw-ring-color, transparent),
        0 0 0 var(--tw-ring-offset-width, 0) var(--tw-ring-offset-color, transparent) !important;
    }
  }

  /* Страховка от остаточного UA outline/glow */
  html :is(input, textarea, select):focus,
  html :is(input, textarea, select):focus-visible {
    outline: 0 !important;
  }
  /* Chrome/Safari (WebKit) */
  html input:-webkit-autofill,
  html input:-webkit-autofill:hover,
  html input:-webkit-autofill:focus,
  html textarea:-webkit-autofill,
  html textarea:-webkit-autofill:hover,
  html textarea:-webkit-autofill:focus,
  html select:-webkit-autofill,
  html select:-webkit-autofill:hover,
  html select:-webkit-autofill:focus {
    -webkit-text-fill-color: hsl(var(--foreground)) !important;
    caret-color: hsl(var(--foreground)) !important;
    -webkit-box-shadow: 0 0 0 1000px var(--rb-autofill-bg) inset !important;
    box-shadow: 0 0 0 1000px var(--rb-autofill-bg) inset !important;
    -webkit-background-clip: padding-box !important;
    border-radius: inherit !important;
    transition: background-color 99999s ease-out 0s !important;
  }

  /* Адресный таргет с повышенной специфичностью */
  html input[data-rb-input]:-webkit-autofill,
  html textarea[data-rb-input]:-webkit-autofill,
  html select[data-rb-input]:-webkit-autofill {
    -webkit-text-fill-color: hsl(var(--foreground)) !important;
    caret-color: hsl(var(--foreground)) !important;
    -webkit-box-shadow: 0 0 0 1000px var(--rb-autofill-bg) inset !important;
    box-shadow: 0 0 0 1000px var(--rb-autofill-bg) inset !important;
    -webkit-background-clip: padding-box !important;
    border-radius: inherit !important;
  }

  /* Стандартный псевдокласс */
  html :is(input, textarea, select):autofill,
  html :is(input[data-rb-input], textarea[data-rb-input], select[data-rb-input]):autofill {
    -webkit-text-fill-color: hsl(var(--foreground)) !important;
    caret-color: hsl(var(--foreground)) !important;
    -webkit-box-shadow: 0 0 0 1000px var(--rb-autofill-bg) inset !important;
    box-shadow: 0 0 0 1000px var(--rb-autofill-bg) inset !important;
  }

  /* Firefox */
  html input:-moz-autofill,
  html textarea:-moz-autofill,
  html select:-moz-autofill {
    color: hsl(var(--foreground)) !important;
    box-shadow: 0 0 0 1000px var(--rb-autofill-bg) inset !important;
  }

  /* Убираем нативный синий outline, не трогая наш ring */
  html :is(input, textarea, select):focus,
  html :is(input, textarea, select):focus-visible {
    outline: 0 !important;
  }

  /* Стабилизируем рендер форм-контролов */
  input, textarea, select {
    -webkit-appearance: none;
    appearance: none;
    color-scheme: var(--rb-color-scheme);
  }

  /* Прячем синий contacts-autofill значок в Safari */
  input::-webkit-contacts-auto-fill-button {
    visibility: hidden;
    display: none !important;
    pointer-events: none;
  }

  /* Запасной канал: если браузер/менеджер паролей не даёт :-webkit-autofill,
     но значение уже вставлено — используем data-атрибут */
  input[data-autocompleted],
  textarea[data-autocompleted],
  select[data-autocompleted] {
    -webkit-text-fill-color: hsl(var(--foreground)) !important;
    caret-color: hsl(var(--foreground)) !important;
    -webkit-box-shadow: 0 0 0 1000px var(--rb-autofill-bg) inset !important;
    box-shadow: 0 0 0 1000px var(--rb-autofill-bg) inset !important;
    -webkit-background-clip: padding-box !important;
    border-radius: inherit !important;
  }
}

@layer utilities {
  .shadow-soft {
    box-shadow: var(--soft-shadow);
  }
  
  .shadow-medium {
    box-shadow: var(--medium-shadow);
  }
  
  .shadow-warm {
    box-shadow: var(--warm-shadow);
  }
  
  .shadow-breathing {
    box-shadow: var(--breathing-shadow);
  }
  
  .text-balance {
    text-wrap: balance;
  }
  
  .bg-texture {
    background-image: 
      radial-gradient(circle at 20% 80%, rgba(244, 239, 232, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(214, 211, 206, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 40% 40%, rgba(174, 182, 175, 0.05) 0%, transparent 50%);
  }
  
  .bg-linen {
    background-image: 
      radial-gradient(circle at 30% 70%, rgba(244, 239, 232, 0.2) 0%, transparent 60%),
      radial-gradient(circle at 70% 30%, rgba(214, 211, 206, 0.15) 0%, transparent 60%);
  }
  
  .text-graceful {
    font-family: var(--font-display), "Cormorant Garamond", serif;
    letter-spacing: 0.02em;
    font-weight: 400;
  }
  
  .backdrop-breathing {
    backdrop-filter: blur(6px);
    background: rgba(250, 249, 247, 0.6);
  }
  
  /* Оптимизация backdrop-filter для мобильных устройств */
  @media (max-width: 768px) {
    .backdrop-breathing {
      backdrop-filter: blur(4px);  /* Меньше размытие для лучшей производительности */
    }
  }
  
  /* Backdrop для темной темы */
  .dark .backdrop-breathing {
    backdrop-filter: blur(12px);
    background: rgba(26, 24, 21, 0.7);  /* Deep Earth с прозрачностью */
  }
  
  /* Оптимизация для темной темы на мобильных */
  @media (max-width: 768px) {
    .dark .backdrop-breathing {
      backdrop-filter: blur(6px);  /* Уменьшено размытие для производительности */
    }
  }
  
  .transition-breathing {
    transition: all 0.8s cubic-bezier(0.22, 1, 0.36, 1);
  }
  
  .bg-misty {
    background-image: 
      radial-gradient(circle at 25% 75%, rgba(244, 239, 232, 0.3) 0%, transparent 50%),
      radial-gradient(circle at 75% 25%, rgba(214, 211, 206, 0.2) 0%, transparent 50%);
  }
  
  /* Фоновые текстуры для темной темы */
  .dark .bg-texture {
    background-image: 
      radial-gradient(circle at 20% 80%, rgba(143, 166, 143, 0.08) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(58, 56, 52, 0.12) 0%, transparent 50%),
      radial-gradient(circle at 40% 40%, rgba(42, 39, 35, 0.1) 0%, transparent 50%);
  }
  
  .dark .bg-linen {
    background-image: 
      radial-gradient(circle at 30% 70%, rgba(143, 166, 143, 0.1) 0%, transparent 60%),
      radial-gradient(circle at 70% 30%, rgba(58, 56, 52, 0.15) 0%, transparent 60%);
  }
  
  .dark .bg-misty {
    background-image: 
      radial-gradient(circle at 25% 75%, rgba(143, 166, 143, 0.12) 0%, transparent 50%),
      radial-gradient(circle at 75% 25%, rgba(58, 56, 52, 0.18) 0%, transparent 50%);
  }
  
  .text-whisper {
    color: rgba(56, 56, 56, 0.7); /* Улучшенная контрастность - темнее и заметнее */
  }
  
  /* Text Whisper для темной темы */
  .dark .text-whisper {
    color: hsl(35 15% 72%);  /* Улучшенная контрастность для темной темы */
  }
  
  .shadow-misty {
    box-shadow: 0 8px 32px rgba(174, 182, 175, 0.12);
  }
  
  .backdrop-misty {
    backdrop-filter: blur(8px);
    background: rgba(250, 249, 247, 0.7);
  }
  
  /* Оптимизация backdrop-misty для мобильных */
  @media (max-width: 768px) {
    .backdrop-misty {
      backdrop-filter: blur(4px);  /* Меньше размытие для производительности */
    }
  }
  
  /* Backdrop misty для темной темы */
  .dark .backdrop-misty {
    backdrop-filter: blur(16px);
    background: rgba(26, 24, 21, 0.8);  /* Более непрозрачный */
  }
  
  /* Оптимизация для темной темы на мобильных */
  @media (max-width: 768px) {
    .dark .backdrop-misty {
      backdrop-filter: blur(8px);  /* Уменьшено размытие для производительности */
    }
  }
  
  /* Shadow misty для темной темы */
  .dark .shadow-misty {
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  }
  
  /* Halo эффект для темной темы */
  .dark .halo {
    background: radial-gradient(
      closest-side,
      rgba(143, 166, 143, 0.18),      /* Sage Glow */
      rgba(143, 166, 143, 0.10) 60%,  /* Приглушенное свечение */
      transparent 70%
    );
  }
  
  /* Veil Bottom для темной темы */
  .dark .veil-bottom {
    background: linear-gradient(
      to top, 
      rgba(255, 255, 255, 0.04),      /* Легкое белое свечение */
      rgba(255, 255, 255, 0)
    );
  }
  
  /* use anim-breath */
  /* .breathing-glow {
    animation: breathing-glow 6s ease-in-out infinite;
  } */
  
  /* --- rosebotanique: motion tokens & utilities --- */
  .anim-breath { 
    animation: rb-breath 12s cubic-bezier(0.22, 1, 0.36, 1) infinite; 
    will-change: transform, opacity;
  }
  .anim-breath-slow { 
    animation: rb-breath-slow 22s ease-in-out infinite; 
    will-change: transform, opacity;
  }
  .anim-delay-2s { animation-delay: 2s; }
  
  /* Typography utilities */
  .smallcaps { 
    letter-spacing: .12em; 
    text-transform: uppercase; 
    font-weight: 500; 
  }
  
  /* Tilt effect */
  .rb-tilt { 
    transform: perspective(600px) rotateX(var(--tiltY,0deg)) rotateY(var(--tiltX,0deg)) translate3d(var(--tx,0),var(--ty,0),0); 
    will-change: transform; 
  }
  
  /* Stroke reveal animation */
  .stroke-reveal { 
    stroke-dasharray: 600; 
    stroke-dashoffset: 600; 
    transition: stroke-dashoffset 2s cubic-bezier(0.22,1,0.36,1); 
  }
  [data-inview="true"] .stroke-reveal { 
    stroke-dashoffset: 0; 
  }
  
  /* Hover mask */
  .mask-stitch { 
    opacity: 0; 
    transition: opacity 600ms cubic-bezier(0.22,1,0.36,1); 
    pointer-events: none; 
  }
  .group:hover .mask-stitch { 
    opacity: .55; 
  }
  .anim-delay-4s { animation-delay: 4s; }
  .anim-float { 
    animation: rb-float 22s ease-in-out infinite; 
  }
.anim-stitch-once { 
  animation: rb-stitch 2.7s cubic-bezier(0.22, 1, 0.36, 1) both 1; 
}

.anim-float-slow { 
  animation: rb-float-slow 18s ease-in-out infinite; 
}

  .rb-bloom-in { 
    animation: rb-bloom-in 1.2s cubic-bezier(0.22, 1, 0.36, 1) both; 
  }
  
  /* уважение к reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .anim-breath, .anim-breath-slow, .anim-float { animation: none !important; }
    .anim-stitch-once { animation-duration: 0.01s; }
  }
}

/* --- rosebotanique · Elven Flower --- */
.rb-flower { 
  --fl-dur: 900ms; 
  --fl-ease: cubic-bezier(0.22,1,0.36,1);
  animation: rb-breathe 4s ease-in-out infinite;
  transition: transform var(--fl-dur) var(--fl-ease);
}
.rb-flower svg { display:block; }

/* общее увеличение цветка при наведении */
.group:hover .rb-flower,
.group:focus-within .rb-flower { transform: scale(1.25); }

/* лепесток: лёгкий поворот и масштаб → раскрываться к 0deg/1 */
.rb-petal {
  transform-box: fill-box;
  transform-origin: 50% 50%;
  transform: rotate(-8deg) scale(.88);
  transition:
    transform var(--fl-dur) var(--fl-ease),
    opacity var(--fl-dur) var(--fl-ease);
  transition-delay: var(--d, 0ms);
}
.rb-petal path{
  stroke-dasharray: 140;
  stroke-dashoffset: 0; /* видимые контуры в покое */
  transition: stroke-dashoffset var(--fl-dur) var(--fl-ease);
  opacity:.5;
}

/* hover/focus раскрывает лепестки полностью */
.group:hover .rb-petal,
.group:focus-within .rb-petal { transform: rotate(0deg) scale(1.2); }
.group:hover .rb-petal path,
.group:focus-within .rb-petal path { stroke-dashoffset: 0; opacity:.75; }

/* сердцевина: мягко «собирается» */
.rb-core{
  transition: transform var(--fl-dur) var(--fl-ease), opacity var(--fl-dur) var(--fl-ease);
  transform: scale(.85);
  opacity:.55;
}
.group:hover .rb-core,
.group:focus-within .rb-core { transform: scale(1.2); opacity:.9; }

/* уважение к reduced motion */
@media (prefers-reduced-motion: reduce){
  .anim-breath, .anim-breath-slow, .anim-float { animation: none !important; }
  .anim-float-slow, .rb-bloom-in { animation: none !important; }
  .rb-flower { animation: none !important; }
  .anim-stitch-once { animation-duration: 0.01s; }
  .rb-petal{ transition: opacity 200ms ease; transform: none !important; }
  .rb-petal path{ transition: opacity 200ms ease; stroke-dashoffset: 0; }
  .rb-core{ transition: opacity 200ms ease; transform: none !important; }
  .stroke-reveal { stroke-dashoffset: 0 !important; }
}

/* Keyframes вне @layer для правильной работы */
@keyframes rb-breath {
  0%,100% { transform: scale(1); opacity: 0.12; }
  50%     { transform: scale(1.03); opacity: 0.20; }
}

@keyframes rb-float {
  0%,100% { transform: translateY(0) rotate(0deg); }
  50%     { transform: translateY(-8px) rotate(0.5deg); }
}

@keyframes rb-stitch {
  0%   { stroke-dashoffset: 120%; }
  100% { stroke-dashoffset: 0%; }
}

@keyframes rb-float-slow {
  0%,100% { transform: translateY(0) rotate(0deg); }
  50%     { transform: translateY(-4px) rotate(0.3deg); }
}

@keyframes rb-bloom-in {
  0%   { transform: scale(.8); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes rb-breathe {
  0%,100% { transform: scale(1); opacity: 0.6; }
  50%     { transform: scale(1.05); opacity: 0.8; }
}

@keyframes rb-breath-slow {
  0%,100% { transform: scale(1); opacity: .12; }
  50%     { transform: scale(1.02); opacity: .2; }
}

@keyframes rb-crossfade { 
  0%, 40%   { opacity: 1 }
  50%, 90%  { opacity: 0 }
  100%      { opacity: 1 }
}

/* Тонкое мерцание звезд */
@keyframes star-twinkle {
  0%, 100% { 
    opacity: 1;
    filter: brightness(1);
  }
  50% { 
    opacity: 0.85;
    filter: brightness(0.9);
  }
}
.rb-crossfade { position: absolute; inset: 0; object-fit: cover; opacity: 0; }
.rb-crossfade--top { animation: rb-crossfade 22s cubic-bezier(0.22,1,0.36,1) infinite; }
.group:hover .rb-crossfade--top,
.group:focus-within .rb-crossfade--top { animation-play-state: paused; }
@media (prefers-reduced-motion: reduce){
  .rb-crossfade--top { animation: none !important; opacity: 0 !important; }
}

/* koru spiral */
.rb-koru svg{display:block}
.koru-stroke{
  stroke-dasharray:600; stroke-dashoffset:0;
  transition:stroke-dashoffset 2.1s cubic-bezier(0.22,1,0.36,1);
  opacity:.75;
}
.koru-leaf{
  transform-box: fill-box; transform-origin:50% 50%;
  transition: transform 900ms cubic-bezier(0.22,1,0.36,1), opacity 900ms cubic-bezier(0.22,1,0.36,1);
}
.koru-breath{ animation: rb-koru-breath 22s ease-in-out infinite }
@keyframes rb-koru-breath{
  0%,100%{ transform: scale(1); opacity:.14 }
  50%{ transform: scale(1.02); opacity:.20 }
}
/* hover/focus раскрытие */
.koru-host:hover .koru-stroke,
.koru-host:focus-within .koru-stroke{ stroke-dashoffset:0 }
.koru-host:hover .koru-leaf,
.koru-host:focus-within .koru-leaf{ transform: rotate(0deg) scale(1.02); opacity:.7 }
/* respect reduced motion */
@media (prefers-reduced-motion: reduce){
  .koru-breath{ animation:none!important }
  .koru-stroke{ transition:none; stroke-dashoffset:0 }
  .koru-leaf{ transition: opacity 200ms ease; transform:none!important }
}

/* --- NOAH stitched label --- */
.noah-wrap {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
}

.noah-stitch {
  display:block;
}
.noah-stitch-path{
  stroke:#aeb6af;
  stroke-width:1.25;
  stroke-linecap:round;
  fill:none;
  stroke-dasharray: 240;
  stroke-dashoffset: 240;
  transition: stroke-dashoffset 1.6s cubic-bezier(0.22,1,0.36,1);
  opacity:.35;
}

/* линия под словом для выравнивания, можно отключить */
.noah-line{
  line-height:1;
}

.noah-word{
  font-family: var(--font-inter, Inter), ui-sans-serif, system-ui, -apple-system;
  font-size: 12px;
  letter-spacing: .18em;           /* стартовый kerning */
  text-transform: uppercase;
  color: rgba(75,75,75,.72);       /* inkSoft/72% */
  opacity: 0;
  transform: translateY(2px);
  transition:
    opacity 420ms cubic-bezier(0.22,1,0.36,1),
    transform 420ms cubic-bezier(0.22,1,0.36,1),
    letter-spacing 300ms cubic-bezier(0.22,1,0.36,1);
}

/* триггер: hover/focus на кнопку CTA */
.about-hover:has(.cta-link:hover) .noah-stitch-path,
.about-hover:has(.cta-link:focus) .noah-stitch-path{
  stroke-dashoffset: 0;
  opacity:.45;
}
.about-hover:has(.cta-link:hover) .noah-word,
.about-hover:has(.cta-link:focus) .noah-word{
  opacity:.9;
  transform: translateY(0);
  letter-spacing: .22em;           /* лёгкое расширение */
}

/* reduced-motion: показать сразу, без анимации */
@media (prefers-reduced-motion: reduce){
  .noah-stitch-path{
    transition:none; stroke-dashoffset:0; opacity:.45;
  }
  .noah-word{
    transition:none; opacity:.9; transform:none; letter-spacing:.22em;
  }
}

/* мобильное поведение (опционально):
   делаем слово видно сразу, чтобы не зависеть от hover */
@media (max-width: 767.98px){
  .noah-word{ opacity:.9; transform:none; }
  .noah-stitch-path{ stroke-dashoffset:0; }
}

/* Saturn Planet */
.rb-nord-disc svg{display:block}
.rb-nord-disc{ 
  opacity: 0.6; /* более заметный */
  perspective: 1000px;
}
.nord-disc-breath{
  transform-style: preserve-3d;
}

/* Дыхание планеты */
.saturn-planet {
  animation: rb-saturn-pulse 24s ease-in-out infinite;
}
@keyframes rb-saturn-pulse{ 
  0%,100%{ transform: scale(1); opacity: 1; }
  50%{ transform: scale(1.08); opacity: 1; }
}

/* Медленное вращение колец */
.saturn-rings-front {
  animation: rb-saturn-rings-rotate 120s linear infinite;
  transform-origin: center;
}
.saturn-rings-back {
  animation: rb-saturn-rings-rotate 140s linear infinite;
  transform-origin: center;
}
@keyframes rb-saturn-rings-rotate{
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Дыхание всего контейнера + наклон из стороны в сторону */
.nord-disc-breath{ 
  animation: rb-disc-breath 22s cubic-bezier(0.22,1,0.36,1) infinite;
}
@keyframes rb-disc-breath{ 
  0%,100%{ transform: scale(1) rotateX(0deg) rotateY(-20deg); }
  25%{ transform: scale(1.01) rotateX(0deg) rotateY(-18deg); }
  50%{ transform: scale(1.02) rotateX(0deg) rotateY(-22deg); }
  75%{ transform: scale(1.01) rotateX(0deg) rotateY(-18deg); }
}

/* Ripple при hover текстовой колонки */
.about-hover:hover .rb-nord-disc,
.about-hover:focus-within .rb-nord-disc{ 
  opacity: .8; 
  transform: scale(1.12);
  transition: opacity 600ms ease-out, transform 600ms ease-out;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){ 
  .nord-disc-breath{ animation: none !important; }
  .saturn-planet{ animation: none !important; }
  .saturn-rings-front{ animation: none !important; }
  .saturn-rings-back{ animation: none !important; }
}

/* Nordic Branch - чистая реализация */
.rb-nordic-branch svg { 
  display: block;
}

.nord-host {
  cursor: pointer;
}

.nord-stem {
  stroke: #aeb6af; 
  stroke-width: 1.4; 
  fill: none; 
  stroke-linecap: round;
  opacity: .8;
}

/* листья: старт из маленького размера */
.nord-leaf {
  transform-box: fill-box;
  transform-origin: center bottom;
  transform: rotate(var(--r,0deg)) scaleY(0.25);
  opacity: .35;
  transition: transform 600ms cubic-bezier(0.34, 1.56, 0.64, 1), opacity 600ms ease-out;
  transition-delay: var(--d, 0ms);
}

/* рост листьев при hover */
.nord-host:hover .nord-stem {
  stroke: #8a9a8a;
  opacity: 1;
}

.nord-host:hover .nord-leaf {
  transform: rotate(var(--r,0deg)) scaleY(1);
  opacity: .75;
}

/* едва заметное покачивание */
.nord-sway { 
  animation: rb-nord-sway 20s ease-in-out infinite;
}

@keyframes rb-nord-sway {
  0%, 100% { transform: rotate(0deg) }
  50% { transform: rotate(0.5deg) }
}

/* reduced motion */
@media (prefers-reduced-motion: reduce) {
  .nord-sway { animation: none !important }
  .nord-leaf { transition: opacity 200ms ease; transform: rotate(var(--r,0deg)) scaleY(0.7); opacity: .6 }
}

/* use anim-breath */
/* @keyframes breathing-glow {
  0%,100% { transform: scale(1); opacity: 0.3; }
  50%     { transform: scale(1.1); opacity: 0.6; }
} */

/* едва заметный дрейф для центра (чуть тише стандартного) */
@keyframes rb-float-slow {
  0%,100% { transform: translateY(0) }
  50%     { transform: translateY(-4px) }
}
.anim-float-slow { animation: rb-float-slow 24s ease-in-out infinite; }

/* мягкий вход цветка (скейл/прозрачность) */
@keyframes rb-bloom-in {
  0%   { transform: scale(.92); opacity: 0 }
  100% { transform: scale(1);   opacity: 1 }
}
.rb-bloom-in { animation: rb-bloom-in 600ms cubic-bezier(0.22,1,0.36,1) both; }

/* autofill detection helper */
@keyframes rb-autofill-start { from { opacity: 1 } to { opacity: 1 } }
input:-webkit-autofill {
  animation-name: rb-autofill-start;
  animation-duration: 0.01s;
}

/* ============================================
   StarField - Реалистичное звездное небо для темной темы
   ============================================ */

/* Контейнер звезд - только в темной теме */
.dark .stars-container {
  opacity: 1;
  transition: opacity 0.8s ease-in-out;
}

/* Базовые стили для звезд - статичные, без анимации */
.stars {
  position: absolute;
  width: 1px;
  height: 1px;
  background: transparent;
  border-radius: 50%;
  /* Убрана анимация - звезды статичны */
}

/* Яркие звезды (самые заметные) - с тонким мерцанием */
.stars-bright {
  width: 2px;
  height: 2px;
  animation: star-twinkle 8s ease-in-out infinite;
  animation-delay: var(--twinkle-delay, 0s);
}

/* Большие звезды - с тонким мерцанием */
.stars-large {
  width: 1.5px;
  height: 1.5px;
  animation: star-twinkle 10s ease-in-out infinite;
  animation-delay: var(--twinkle-delay, 0s);
}

/* Средние звезды - с тонким мерцанием */
.stars-medium {
  width: 1.2px;
  height: 1.2px;
  animation: star-twinkle 12s ease-in-out infinite;
  animation-delay: var(--twinkle-delay, 0s);
}

/* Маленькие звезды - без мерцания для производительности */
.stars-small {
  width: 1px;
  height: 1px;
}

/* Очень маленькие звезды - без мерцания для производительности */
.stars-tiny {
  width: 0.7px;
  height: 0.7px;
}

/* Отключаем мерцание на мобильных для производительности */
@media (max-width: 768px) {
  .stars-bright,
  .stars-large,
  .stars-medium {
    animation: none;
  }
}

/* Уважение к reduced motion */
@media (prefers-reduced-motion: reduce) {
  .stars-bright,
  .stars-large,
  .stars-medium {
    animation: none !important;
  }
}

/* Скрытие скроллбара */
.scrollbar-hide {
  -ms-overflow-style: none;  /* IE и Edge */
  scrollbar-width: none;  /* Firefox */
}

.scrollbar-hide::-webkit-scrollbar {
  display: none;  /* Chrome, Safari и Opera */
}

