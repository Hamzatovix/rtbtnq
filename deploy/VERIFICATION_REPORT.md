# ‚úÖ –û—Ç—á—ë—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

## üì§ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –°—Ç–∞—Ç—É—Å: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–§–∞–π–ª:** `front/src/app/api/upload/image/route.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–±–µ–∑ Vercel Blob)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `/public/uploads/{folder}/{filename}`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ (—Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ (–º–∞–∫—Å–∏–º—É–º 5MB)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ URL `/uploads/{folder}/{filename}`
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫

**–ü—É—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:**
- –¢–æ–≤–∞—Ä—ã: `/app/public/uploads/products/`
- –ì–∞–ª–µ—Ä–µ—è: `/app/public/uploads/gallery/`

**URL –¥–æ—Å—Ç—É–ø–∞:**
- `https://rosebotanique.store/uploads/products/—Ñ–∞–π–ª.jpg`
- `http://176.57.213.174:3000/uploads/products/—Ñ–∞–π–ª.jpg`

---

## ‚ûï –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤

### –°—Ç–∞—Ç—É—Å: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**API:** `POST /api/products`

**–§–∞–π–ª—ã:**
- `front/src/app/api/products/route.ts` (POST handler)
- `front/src/app/backoffice/products/new/page.tsx` (UI —Ñ–æ—Ä–º–∞)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü—Ä–∏–Ω–∏–º–∞–µ—Ç JSON –∏–ª–∏ FormData
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π (name, slug)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ slug
- ‚úÖ –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è ID (timestamp)
- ‚úÖ –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è SKU –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `saveProducts()` —Å–µ—Ä–≤–∏—Å
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ —É—Ö–æ–¥–∞
- ‚úÖ –§–ª–∞–≥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (isPublished)

**–ü–æ–ª—è —Ç–æ–≤–∞—Ä–∞:**
- `name` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `slug` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- `description`
- `materials`
- `care`
- `categoryId`
- `isPublished` (boolean)
- `variants[]` (–º–∞—Å—Å–∏–≤ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)

**–í–∞—Ä–∏–∞–Ω—Ç —Ç–æ–≤–∞—Ä–∞:**
- `colorId`
- `priceCents`
- `sku` (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω)
- `currency` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 'RUB')
- `stockQty`
- `isDefault` (–ø–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `images[]` (–º–∞—Å—Å–∏–≤ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

---

## ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤

### –°—Ç–∞—Ç—É—Å: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**API:** `PUT /api/products/[id]`

**–§–∞–π–ª—ã:**
- `front/src/app/api/products/[id]/route.ts` (PUT handler)
- `front/src/app/backoffice/products/[id]/edit/page.tsx` (UI —Ñ–æ—Ä–º–∞)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü—Ä–∏–Ω–∏–º–∞–µ—Ç JSON –∏–ª–∏ FormData
- ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—è)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
- ‚úÖ –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è SKU –¥–ª—è –Ω–æ–≤—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `updatedAt` timestamp
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `saveProducts()` —Å–µ—Ä–≤–∏—Å
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç 404 –µ—Å–ª–∏ —Ç–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–æ–ª—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
- `name`
- `slug`
- `description`
- `materials`
- `care`
- `categoryId`
- `isPublished`
- `variants[]`

---

## üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤

### –°—Ç–∞—Ç—É—Å: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**API:** `DELETE /api/products/[id]`

**–§–∞–π–ª—ã:**
- `front/src/app/api/products/[id]/route.ts` (DELETE handler)
- `front/src/app/backoffice/products/page.tsx` (UI —Å–ø–∏—Å–æ–∫)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ ID
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–∑ –º–∞—Å—Å–∏–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç 404 –µ—Å–ª–∏ —Ç–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –≤ UI (confirm dialog)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è

---

## üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –°—Ç–∞—Ç—É—Å: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–§–∞–π–ª:** `front/src/server/products/products-json.service.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ (TTL: 5 —Å–µ–∫—É–Ω–¥)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ JSON —Ñ–∞–π–ª (`src/data/products.json`)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ `wrapped` (—Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ `array` (–ø—Ä–æ—Å—Ç–æ–π –º–∞—Å—Å–∏–≤)
- ‚úÖ Fallback –Ω–∞ Supabase (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:**
```json
{
  "count": 10,
  "next": null,
  "previous": null,
  "results": [
    {
      "id": "1234567890",
      "slug": "product-name",
      "name": "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞",
      "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
      "categoryId": "1",
      "isPublished": true,
      "variants": [...]
    }
  ]
}
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Ç–µ–π

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ `/public/uploads/products/` - —Ç–æ–≤–∞—Ä—ã
- ‚úÖ `/public/uploads/gallery/` - –≥–∞–ª–µ—Ä–µ—è
- ‚úÖ Volume –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è: `/opt/rosebotanique/front/public/uploads:/app/public/uploads`

### –î–∞–Ω–Ω—ã–µ
- ‚úÖ `/src/data/products.json` - —Ç–æ–≤–∞—Ä—ã
- ‚úÖ `/src/data/categories.json` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ `/src/data/colors.json` - —Ü–≤–µ—Ç–∞
- ‚úÖ Volume –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è: `/opt/rosebotanique/front/src/data:/app/src/data`

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `/prisma_data/prod.db` - SQLite –±–∞–∑–∞
- ‚úÖ Volume –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è: `/opt/rosebotanique/front/prisma_data:/app/prisma_data`

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
   ```bash
   curl -X POST http://localhost:3000/api/upload/image \
     -F "file=@test.jpg" \
     -F "folder=products"
   ```

2. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:**
   ```bash
   curl -X POST http://localhost:3000/api/products \
     -H "Content-Type: application/json" \
     -d '{"name":"Test","slug":"test","variants":[]}'
   ```

3. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:**
   ```bash
   curl -X PUT http://localhost:3000/api/products/1234567890 \
     -H "Content-Type: application/json" \
     -d '{"name":"Updated Name"}'
   ```

4. **–£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:**
   ```bash
   curl -X DELETE http://localhost:3000/api/products/1234567890
   ```

---

## ‚úÖ –ò—Ç–æ–≥

–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ JSON —Ñ–∞–π–ª—ã
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ

