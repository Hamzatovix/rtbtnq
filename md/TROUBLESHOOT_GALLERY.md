# üîç –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≥–∞–ª–µ—Ä–µ–∏

## –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ Supabase)
- ‚ùå –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –±—ç–∫-–æ—Ñ–∏—Å–µ
- ‚ùå –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ

## –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç

```
[Gallery] –ó–∞–≥—Ä—É–∑–∫–∞ –≥–∞–ª–µ—Ä–µ–∏: {
  isVercel: true,
  supabaseEnabled: true,
  hasSupabaseUrl: true,
  hasSupabaseKey: true
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –ª–æ–≥–æ–≤ –∏–∑ `loadGalleryFromSupabase`, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
- –õ–∏–±–æ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
- –õ–∏–±–æ –æ–Ω–∞ –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π –¥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –õ–∏–±–æ –∑–∞–ø—Ä–æ—Å –∫ Supabase –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ Supabase –Ω–∞–ø—Ä—è–º—É—é

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ Supabase SQL Editor:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö
SELECT COUNT(*) FROM gallery;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
SELECT id, src, alt, data, created_at FROM gallery LIMIT 5;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö –∏–ª–∏ —Ç–æ–ª—å–∫–æ –≤ data
SELECT 
  id,
  CASE WHEN src IS NULL OR src = '' THEN 'empty' ELSE 'has_value' END as src_status,
  CASE WHEN alt IS NULL OR alt = '' THEN 'empty' ELSE 'has_value' END as alt_status,
  CASE WHEN data IS NULL THEN 'empty' ELSE 'has_value' END as data_status,
  data
FROM gallery;
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –Ω–∞–ø—Ä—è–º—É—é

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://–≤–∞—à-–¥–æ–º–µ–Ω.vercel.app/api/gallery
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "images": [
    {
      "id": "...",
      "src": "https://...",
      "alt": "..."
    }
  ]
}
```

**–ï—Å–ª–∏ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ `[]`:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –≤ Supabase

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

**–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:**
```
[Gallery] –ó–∞–≥—Ä—É–∑–∫–∞ –≥–∞–ª–µ—Ä–µ–∏: { ... }
[Gallery] –í—ã–∑—ã–≤–∞–µ–º loadGalleryFromSupabase...
[Gallery] –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ Supabase, —Ç–∞–±–ª–∏—Ü–∞: gallery
[Supabase] –ó–∞–ø—Ä–æ—Å: { method: 'GET', url: '...', hasAuth: true }
[Supabase] –û—Ç–≤–µ—Ç: { status: 200, ok: true }
[Gallery] –ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase: { ... }
[Gallery] –ò—Ç–æ–≥–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: X
```

**–ï—Å–ª–∏ –Ω–µ—Ç –ª–æ–≥–æ–≤ `[Supabase] –ó–∞–ø—Ä–æ—Å:`:**
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ Vercel

**–ï—Å–ª–∏ –µ—Å—Ç—å `[Supabase] –û—Ç–≤–µ—Ç: { status: 404 }`:**
- –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã –≤ Supabase

**–ï—Å–ª–∏ –µ—Å—Ç—å `[Supabase] –û—Ç–≤–µ—Ç: { status: 401 }`:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `SUPABASE_SERVICE_ROLE_KEY`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel

**–ï—Å–ª–∏ –µ—Å—Ç—å `[Supabase] –û—Ç–≤–µ—Ç: { status: 200 }`, –Ω–æ –¥–∞–Ω–Ω—ã–µ –ø—É—Å—Ç—ã–µ:**
- –¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ Supabase

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –≤ Supabase

–í Supabase Table Editor ‚Üí `gallery` –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –î–∞–Ω–Ω—ã–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö**
```
id: "abc123"
src: "https://blob.vercel-storage.com/gallery/..."
alt: "–æ–ø–∏—Å–∞–Ω–∏–µ"
data: null –∏–ª–∏ {}
```

**–í–∞—Ä–∏–∞–Ω—Ç –ë: –î–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ –ø–æ–ª–µ data (JSONB)**
```
id: "abc123"
src: null –∏–ª–∏ ""
alt: null –∏–ª–∏ ""
data: {"id": "abc123", "src": "https://...", "alt": "–æ–ø–∏—Å–∞–Ω–∏–µ"}
```

**–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ `data`:**
–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫:
```sql
UPDATE gallery 
SET 
  src = COALESCE(NULLIF(src, ''), (data->>'src')::text),
  alt = COALESCE(NULLIF(alt, ''), (data->>'alt')::text)
WHERE (src IS NULL OR src = '') AND data IS NOT NULL AND data->>'src' IS NOT NULL;
```

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í Vercel Dashboard ‚Üí Settings ‚Üí Environment Variables:

- ‚úÖ `SUPABASE_URL` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–Ω—ã–π URL (https://xxx.supabase.co)
- ‚úÖ `SUPABASE_SERVICE_ROLE_KEY` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å service_role key (–Ω–µ anon!)
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫ **Production**

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–¥–µ–ª–∞–π—Ç–µ **Redeploy**.

### 6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã

–í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
```typescript
const SUPABASE_GALLERY_TABLE = process.env.SUPABASE_GALLERY_TABLE || 'gallery'
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- –¢–∞–±–ª–∏—Ü–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `gallery` (–≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ)
- –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `SUPABASE_GALLERY_TABLE` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º

## üêõ –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–ü—Ä–∏—á–∏–Ω–∞:** –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Supabase

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:
   ```
   [Gallery] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–∞–ª–µ—Ä–µ–∏: { ... }
   [Gallery] –ò—Å–ø–æ–ª—å–∑—É–µ–º Supabase –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
   ```
2. –ï—Å–ª–∏ –Ω–µ—Ç –ª–æ–≥–∞ "–ò—Å–ø–æ–ª—å–∑—É–µ–º Supabase" - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∞–Ω–Ω—ã–µ –µ—Å—Ç—å, –Ω–æ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ `[Gallery] –ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase`
2. –ï—Å–ª–∏ `count: 0` - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ Supabase –Ω–∞–ø—Ä—è–º—É—é
3. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å, –Ω–æ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ 404 –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ Supabase

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã –≤ Supabase
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `gallery` (–≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `SUPABASE_GALLERY_TABLE` –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞

## üìã –ß–µ–∫–ª–∏—Å—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –≤ Supabase (–µ—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å–∏?)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (–≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ?)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω API `/api/gallery` –Ω–∞–ø—Ä—è–º—É—é (—á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç?)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–≥–∏ Vercel (–µ—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏?)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–∏?)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏?)
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üîß –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å –≤ Supabase, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:**
```sql
SELECT * FROM gallery LIMIT 1;
```

2. **–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ `data`, –æ–±–Ω–æ–≤–∏—Ç–µ –∫–æ–ª–æ–Ω–∫–∏:**
```sql
UPDATE gallery 
SET 
  src = COALESCE(NULLIF(src, ''), (data->>'src')::text),
  alt = COALESCE(NULLIF(alt, ''), (data->>'alt')::text)
WHERE (src IS NULL OR src = '') AND data IS NOT NULL;
```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API:**
```
https://–≤–∞—à-–¥–æ–º–µ–Ω.vercel.app/api/gallery
```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel** –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞

