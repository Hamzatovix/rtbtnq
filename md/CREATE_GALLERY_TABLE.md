# üóÑÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã gallery –≤ Supabase

## ‚ùå –û—à–∏–±–∫–∞

```
Error: Failed to run sql query: ERROR: 42P01: relation "gallery" does not exist
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `gallery` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –≤–∞—à–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö Supabase.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [https://app.supabase.com](https://app.supabase.com)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ **SQL Editor**

### –®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç SQL:

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã gallery –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≥–∞–ª–µ—Ä–µ–∏
CREATE TABLE IF NOT EXISTS gallery (
  id TEXT PRIMARY KEY,
  src TEXT NOT NULL,
  alt TEXT DEFAULT '',
  data JSONB,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
CREATE INDEX IF NOT EXISTS idx_gallery_created_at ON gallery(created_at);
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã

1. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ **Table Editor**
2. –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —Ç–∞–±–ª–∏—Ü–∞ `gallery`
3. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É `gallery` - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–æ–ª–æ–Ω–∫–∏:
   - `id` (text)
   - `src` (text)
   - `alt` (text)
   - `data` (jsonb)
   - `created_at` (timestamptz)
   - `updated_at` (timestamptz)

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

–í Supabase —Ç–∞–±–ª–∏—Ü—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å **Row Level Security (RLS)**. –ï—Å–ª–∏ RLS –≤–∫–ª—é—á–µ–Ω, –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. –í Table Editor ‚Üí `gallery` ‚Üí –Ω–∞–π–¥–∏—Ç–µ –∏–∫–æ–Ω–∫—É –∑–∞–º–∫–∞ üîí
2. –ï—Å–ª–∏ RLS –≤–∫–ª—é—á–µ–Ω (–∑–∞–º–æ–∫ –∑–∞–∫—Ä—ã—Ç), –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –û—Ç–∫–ª—é—á–∏—Ç—å RLS (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ service_role key –¥–ª—è –∑–∞–ø–∏—Å–∏)
ALTER TABLE gallery DISABLE ROW LEVEL SECURITY;

-- –ò–õ–ò —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è service_role
ALTER TABLE gallery ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Allow service role full access" 
ON gallery FOR ALL 
USING (true) 
WITH CHECK (true);
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `SUPABASE_SERVICE_ROLE_KEY` –¥–ª—è –∑–∞–ø–∏—Å–∏ (—á—Ç–æ –∏ –¥–µ–ª–∞–µ—Ç—Å—è –≤ –∫–æ–¥–µ), –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å RLS –¥–ª—è —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã.

## ‚úÖ –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã

1. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –¥–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –≥–∞–ª–µ—Ä–µ—é
2. –û—à–∏–±–∫–∞ `relation "gallery" does not exist` –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å
3. –î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `gallery`

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Vercel
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `/backoffice/gallery`
3. –î–æ–±–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Supabase ‚Üí Table Editor ‚Üí `gallery` - –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

## üêõ –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è

### –ü—Ä–æ–±–ª–µ–º–∞: "permission denied"

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∏ –∏–º–µ–µ—Ç–µ –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

### –ü—Ä–æ–±–ª–µ–º–∞: "syntax error"

**–†–µ—à–µ–Ω–∏–µ:** 
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ PostgreSQL —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –∫–∞–≤—ã—á–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
- –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ –æ–¥–Ω–æ–π, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è (—Å–º. –®–∞–≥ 3)
2. RLS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Å–º. –®–∞–≥ 4)
3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
4. –ù–æ–≤—ã–π –¥–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã

## üìã –ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

```sql
CREATE TABLE IF NOT EXISTS gallery (
  id TEXT PRIMARY KEY,
  src TEXT NOT NULL,
  alt TEXT DEFAULT '',
  data JSONB,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX IF NOT EXISTS idx_gallery_created_at ON gallery(created_at);

ALTER TABLE gallery DISABLE ROW LEVEL SECURITY;
```

